head(pca.ge)
pca.ge <- cbind(pca.ge[, grepl("B6", grp4)], pca.ge[, ! grepl("B6", grp4)])
head(pca.ge)
pca <- prcomp(pca.ge)
barplot(pca$sdev)
pca$sdev / sum(pca$sdev)
cumsum(pca$sdev / sum(pca$sdev))
plot(cumsum(pca$sdev / sum(pca$sdev)))
barplot(cumsum(pca$sdev / sum(pca$sdev)))
barplot(pca$sdev / sum(pca$dev))
barplot(pca$sdev / sum(pca$sdev))
barplot(pca$sdev)
barplot(pca$sdev / sum(pca$sdev))
sum(pca$sdev)
barplot(pca$sdev / sum(pca$sdev), xlab = "PC", ylab = "% variants explained")
barplot(pca$sdev / sum(pca$sdev), xlab = "PC", ylab = "% variants explained")
barplot(pca$rotation[, 1], las = 2, col = as.numeric(grp4))
barplot(pca$rotation[, 2], las = 2, col = as.numeric(grp4))
barplot(pca$rotation[, 3], las = 2, col = as.numeric(grp4))
barplot(pca$rotation[, 4], las = 2, col = as.numeric(grp4))
barplot(pca$rotation[, 5], las = 2, col = as.numeric(grp4))
barplot(pca$rotation[, 6], las = 2, col = as.numeric(grp4))
barplot(pca$rotation[, 7], las = 2, col = as.numeric(grp4))
barplot(pca$rotation[, 8], las = 2, col = as.numeric(grp4))
barplot(pca$rotation[, 9], las = 2, col = as.numeric(grp4))
barplot(pca$rotation[, 10], las = 2, col = as.numeric(grp4))
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
pdf("pdf/pca.pdf", width = 8, height = 5)
lapply(1:10, function(x) barplot(pca$rotation[, x], las = 2, col = as.numeric(grp4)))
dev.off()
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) barplot(pca$rotation[, x], las = 2, col = as.numeric(grp4)))
dev.off()
grp4
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(pca$rotation[, x], las = 2, col = as.numeric(grp4), xaxt = "n")
axis(1, at = x, label = grp4, las=2)
})
grp4
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(pca$rotation[, x], las = 2, col = as.numeric(grp4), xaxt = "n")
axis(1, at = x, labels = grp4, las=2)
})
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(pca$rotation[, x], las = 2, col = as.numeric(grp4), xaxt = "n")
axis(1, labels = grp4, las=2)
})
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(pca$rotation[, x], las = 2, col = as.numeric(grp4), xaxt = "n")
axis(1, at = 1:35, labels = grp4, las=2)
})
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(pca$rotation[, x], las = 2, col = as.numeric(grp4), xaxt = "n")
axis(1, at = 1:35, labels = grp4, las=2)
})
grp1
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(pca$rotation[, x], las = 2, col = as.numeric(grp4), xaxt = "n")
axis(1, at = grp1, labels = grp4, las=2)
})
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(pca$rotation[, x], las = 2, col = as.numeric(grp4), xaxt = "n")
axis(1, at = pca$rotation[, x], labels = grp4, las=2)
})
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(pca$rotation[, x], las = 2, col = as.numeric(grp4), xaxt = "n")
axis(1, at = pca$rotation[, x], las=2)
})
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(pca$rotation[, x], las = 2, col = as.numeric(grp4), xaxt = "n")
})
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(pca$rotation[, x], las = 2, col = as.numeric(grp4), xaxt = "n")
axis(1, at = pca$rotation[, x], las=2)
})
dev.off()
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(pca$rotation[, x], las = 2, col = as.numeric(grp4), xaxt = "n")
axis(1, at = pca$rotation[, x], labels = grp4, las=2)
})
dev.off()
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(pca$rotation[, x], las = 2, col = as.numeric(grp4), xaxt = "n")
axis(1, at = 1:35, labels = grp4, las=2)
})
dev.off()
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(pca$rotation[, x], col = as.numeric(grp4), xaxt = "n")
axis(1, at = 1:35, labels = gsub("-.*", "", colnames(pca.ge)), las=2)
})
dev.off()
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(pca$rotation[, x], col = as.numeric(grp4), xaxt = "n")
axis(1, at =pca$rotation[, x] , labels = gsub("-.*", "", colnames(pca.ge)), las=2)
})
dev.off()
pca$rotation[, x]
pca$rotation[, 1]
names(rotation[, 1])
names(pca$rotation[, 1])
names(pca$rotation[, 1]) = gsub("-.*", "", names(pca$rotation[, 1]))
pca$rotation[, 1]
head(pca$rotation)
rownames(pca$rotation) = gsub("-.*", "", rownames(pca$rotation))
head(pca$rotation)
rotation <- pca$rotation
rownames(rotation) = gsub("-.*", "", rownames(rotation))
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) barplot(rotation[, x], las = 2, col = as.numeric(grp4), xaxt = "n"))
dev.off()
rotation
barplot(rotation[ ,1])
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) barplot(rotation[, x], col = as.numeric(grp4), xaxt = "n"))
dev.off()
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) barplot(rotation[, x], col = 1:6))
dev.off()
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) barplot(rotation[, x], col = as.numeric(grp4)))
dev.off()
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) barplot(rotation[, x], las = 2, col = as.numeric(grp4)))
dev.off()
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) barplot(rotation[, x], col = as.numeric(grp4)))
dev.off()
c(1:6) * 2
c(1:6) * 3
c(1:6) * 6
c(1:6) * 5
barplot(rotation[, 1], col = as.numeric(grp4), xaxt = "n")
axis(side = 1, at = c(1:6) * 5,labels = T)
barplot(rotation[, 1], col = as.numeric(grp4), xaxt = "n")
axis(side = 1, at = c(1:6) * 5.5,labels = T)
barplot(rotation[, 1], col = as.numeric(grp4), xaxt = "n")
axis(side = 1, at = c(1:6) * 6,labels = T)
barplot(rotation[, 1], col = as.numeric(grp4), xaxt = "n")
axis(side = 1, at = c(1:6) * 7,labels = T)
barplot(rotation[, 1], col = as.numeric(grp4), xaxt = "n")
axis(side = 1, at = c(1:6) * 7 - 3,labels = T)
barplot(rotation[, 1], col = as.numeric(grp4), xaxt = "n")
axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
grp3
pdf("pdf/pca.pdf", width = 8, height = 5)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(grp4), xaxt = "n")
axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(grp4), xaxt = "n")
axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
}); dev.off()
barplot(rotation[, 9], col = as.numeric(grp4), xaxt = "n")
barplot(rotation[, 10], col = as.numeric(grp4), xaxt = "n")
?axis
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(grp4), xaxt = "n")
axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3, padj = 1)
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(grp4), xaxt = "n")
axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3, padj = 10)
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(grp4), xaxt = "n")
axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3, hadj = 10)
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(grp4), xaxt = "n")
axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(grp4), xaxt = "n")
axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
legend("topleft", levels(grp4), col = seq_along(grp4), pch=1)
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(grp4), xaxt = "n")
axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
# legend("topleft", levels(grp4), col = seq_along(grp4), pch=1)
legend("topleft", levels(grp4), col = as.numeric(grp4), pch=1)
}); dev.off()
grp4
rownames(rotation)
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(grp4), xaxt = "n")
axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
legend("topleft", levels(grp4), col = seq_along(rownames(rotation)), pch=1)
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(rownames(rotation)), xaxt = "n")
axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
legend("topleft", levels(grp4), col = seq_along(rownames(rotation)), pch=1)
}); dev.off()
group <- factor(rownames(rotation))
group
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
legend("topleft", levels(grp4), col = seq_along(group), pch=1)
}); dev.off()
str(group)
group <- factor(rownames(rotation), levels = grp3)
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
legend("topleft", levels(grp4), col = seq_along(group), pch=1)
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
legend("topleft", levels(grp4), col = seq_along(group), pch = 2)
}); dev.off()
?pch
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
legend("topleft", levels(grp4), col = seq_along(group), pch = 19)
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
# axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
legend("topleft", levels(grp4), col = seq_along(group), pch = 19)
}); dev.off()
?legend
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
# axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
legend("topleft", levels(grp4), col = seq_along(group), pch = 19, horiz = T)
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
# axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
legend("topleft", levels(grp4), col = seq_along(group), pch = 19, horiz = T, vjust = 10)
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
# axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
legend("topleft", levels(grp4), col = seq_along(group), pch = 19, horiz = T, yjust = 10)
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
# axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
legend("topleft", levels(grp4), col = seq_along(group), pch = 19, horiz = T)
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
# axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
legend("bottom", levels(grp4), col = seq_along(group), pch = 19, horiz = T)
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
# axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
if (x == 1) legend("topleft", levels(grp4), col = seq_along(group), pch = 19)
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
# axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
if (x == 1) legend("topleft", levels(grp4), col = seq_along(group), pch = 19, border = "white")
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
# axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
if (x == 1) legend("topleft", levels(grp4), col = seq_along(group), pch = 19, box.col = "white")
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
# axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
if (x == 2) legend("topleft", levels(grp4), col = seq_along(group), pch = 19)
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
# axis(side = 1, at = c(1:6) * 7 - 3, labels = grp3)
if (x == 2) legend("topleft", levels(grp4), col = seq_along(group), pch = 19, cex = 0.5)
}); dev.off()
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:10, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
if (x %in% 1:4) legend("topleft", levels(grp4), col = seq_along(group), pch = 19, cex = 0.7)
}); dev.off()
barplot(pca$sdev / sum(pca$sdev), xlab = "PC", ylab = "% variants explained")
barplot(pca$sdev / sum(pca$sdev), xlab = "PC", ylab = "% variants explained",
col = c(rep("red", 10)))
barplot(pca$sdev / sum(pca$sdev), xlab = "PC", ylab = "% variants explained",
col = c(rep("red", 10), rep("grey", 25)))
barplot(pca$sdev / sum(pca$sdev), xlab = "PC", ylab = "% variants explained",
col = c(rep("red", 6), rep("grey", 29)))
pdf("pdf/pca.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:6, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
if (x %in% 1:4) legend("topleft", levels(grp4), col = seq_along(group), pch = 19, cex = 0.7)
}); dev.off()
pdf("pdf/var.pdf", width = 8, height = 5)
barplot(pca$sdev / sum(pca$sdev), col = c(rep("red", 6), rep("grey", 29)),
xlab = "PC", ylab = "% variants explained")
dev.off()
pdf("pdf/pcs.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:12, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
if (x %in% 1:4) legend("topleft", levels(grp4), col = seq_along(group), pch = 19, cex = 0.7)
}); dev.off()
dim(pca.ge)
?anova
head(ge)
head(grp4)
fit <- apply(ge, 1, function(x) lm(x ~ grp4))
length(fit)
fit[[1]]
anova(fit[[1]])
head(fit.pv)
x  = anova(fit[[1]])
str(x)
x$Pr(>F)
summary(x)
x[["Pr(>F)"]]
x
x["grp4", "Pr(>F)"]
anova <- lapply(fit, anova)
anova[[1]]["grp4", "Pr(>F)"]
pvalue.anova <- sapply(anova, function(x) x["grp4", "Pr(>F)"])
pvalue.anova
head(pvalue.anova)
x
table(pvalue.anova < 0.05)
ge.anova <- ge[pvalue.anova < 0.05, ]
pca.ge <- ge[pvalue.anova < 0.05, ]
head(pca.ge)
pca.ge <- pca.ge - rowMeans(pca.ge[, grep("B6", colnames(pca.ge))])
pca.ge <- cbind(pca.ge[, grepl("B6", grp4)], pca.ge[, ! grepl("B6", grp4)])
pca <- prcomp(pca.ge)
barplot(pca$sdev / sum(pca$sdev), col = c(rep("red", 6), rep("grey", 29)),
xlab = "PC", ylab = "% variants explained")
barplot(pca$sdev / sum(pca$sdev), col = c(rep("red", 6), rep("grey", 29)),
xlab = "PC", ylab = "% variants explained")
barplot(pca$sdev / sum(pca$sdev), col = c(rep("red", 6), rep("grey", 29)),
xlab = "PC", ylab = "% variants explained")
rotation <- pca$rotation
rownames(rotation) = gsub("-.*", "", rownames(rotation))
group <- factor(rownames(rotation), levels = grp3)
pdf("pdf/pcs.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:12, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
if (x %in% 1:4) legend("topleft", levels(grp4), col = seq_along(group), pch = 19, cex = 0.7)
}); dev.off()
pdf("pdf/var.pdf", width = 8, height = 5)
barplot(pca$sdev / sum(pca$sdev), col = c(rep("red", 6), rep("grey", 29)),
xlab = "PC", ylab = "% variants explained")
dev.off()
dim(ge)
for(obj in names(myList)) assign(obj, myList[[obj]])
dim(ge)
library(dplyr)
library(quantro)
library(preprocessCore)
library(genefilter)
library(VennDiagram)
library(png)
rm(list = ls())
setwd("~/Dropbox/GitHub/Load/")
load("data/myList.rdt")
for(obj in names(myList)) assign(obj, myList[[obj]])
dim(ge)
grp1 <- colnames(ge)
grp2 <- c("ApoE4", "Apoe", "Bin1", "Cd2ap", "Clu")
grp3 <- c("B6", "ApoE4", "Apoe", "Bin1", "Cd2ap", "Clu")
grp4 <- factor(gsub("-.*", "", grp1), levels = grp3)
ge <- log2(ge + 1)
table(rowMax(ge) > 3)
?rowMax
rowMax()
rm(list = ls())
setwd("~/Dropbox/GitHub/Load/")
load("data/myList.rdt")
for(obj in names(myList)) assign(obj, myList[[obj]])
grp1 <- colnames(ge)
grp2 <- c("ApoE4", "Apoe", "Bin1", "Cd2ap", "Clu")
grp3 <- c("B6", "ApoE4", "Apoe", "Bin1", "Cd2ap", "Clu")
grp4 <- factor(gsub("-.*", "", grp1), levels = grp3)
colnames(ge)
rm(list = ls())
setwd("~/Dropbox/GitHub/Load/")
load("data/myList.rdt")
for(obj in names(myList)) assign(obj, myList[[obj]])
grp1 <- colnames(ge)
grp2 <- c("ApoE4", "Apoe", "Bin1", "Cd2ap", "Clu")
grp3 <- c("B6", "ApoE4", "Apoe", "Bin1", "Cd2ap", "Clu")
grp4 <- factor(gsub("-.*", "", grp1), levels = grp3)
ge <- log2(ge + 1)
fit <- apply(ge, 1, function(x) lm(x ~ grp4))
anova <- lapply(fit, anova)
anova.pval <- sapply(anova, function(x) x["grp4", "Pr(>F)"])
pca.ge <- ge[anova.pval < 0.05, ]
str(pca.ge)
pca.ge <- pca.ge - rowMeans(pca.ge[, grep("B6", colnames(pca.ge))])
pca.ge <- cbind(pca.ge[, grepl("B6", grp4)], pca.ge[, ! grepl("B6", grp4)])
pca <- prcomp(pca.ge)
barplot(pca$sdev / sum(pca$sdev), col = c(rep("red", 6), rep("grey", 29)),
xlab = "PC", ylab = "% variants explained")
pdf("pdf/var.pdf", width = 8, height = 5)
barplot(pca$sdev / sum(pca$sdev), col = c(rep("red", 6), rep("grey", 29)),
xlab = "PC", ylab = "% variants explained")
dev.off()
rotation <- pca$rotation
rownames(rotation) = gsub("-.*", "", rownames(rotation))
group <- factor(rownames(rotation), levels = grp3)
pdf("pdf/pcs.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:12, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
if (x %in% 1:4) legend("topleft", levels(grp4), col = seq_along(group), pch = 19, cex = 0.7)
}); dev.off()
rotation <- -pca$rotation
rownames(rotation) = gsub("-.*", "", rownames(rotation))
group <- factor(rownames(rotation), levels = grp3)
pdf("pdf/pcs.pdf", width = 10, height = 7)
par(mfrow = c(1, 2), mar = c(10, 4, 4, 2))
lapply(1:12, function(x) {
barplot(rotation[, x], col = as.numeric(group), xaxt = "n")
if (x %in% 1:4) legend("topleft", levels(grp4), col = seq_along(group), pch = 19, cex = 0.7)
}); dev.off()
str(pca)
pca$x[, 4]
hist(pca$x[, 4])
